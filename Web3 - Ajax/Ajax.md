# Ajax

## Ajax?
 - ex) 검색엔진의 검색어 자동완성 기능
 - 페이지 전체를 reloading 하면 사용자의 관심이 분산되고, 서버 입장에서도 모든
   페이지를 다시 전송해야 하기 때문에 손실이 컸다. 이런 불만족 속에서 피어난 꽃이 Ajax이다.
 - 필요한 정보만을 부분적으로, 정교하게 낚아채는 기술
 - 클라이언트를 사용하는 사용자에게는 좋은 경험을, 서버를 운영하는 생산자에게는
   지출을 줄여준다. 

## 수업의 목적
 - 크롬 개발자 도구의 Network Tab을 통해 브라우저가 웹 서버와 어떤 정보를 
   주고받는지 확인할 수 있다.
 - 비슷한 정보를 가진 페이지들을 페이지를 열 때마다 다운로드 받는다?? 매우 비효율적임.
 - 사용자가 원하는 정보만 부분적으로 웹 페이지를 갱신하도록 돕는 기술이 Ajax 이다.
 - Ajax를 사용함에 따라 얻을 수 있는 이점
  + 사용성의 증대 : 사용자들은 변경되는 부분에만 집중할 수 있다.
  + 필요한 부분만 부분적으로 로드할 수 있다.
    -> 서버 뿐만 아니라, 웹 브라우저를 사용하는 사용자 입장에서도 시간, 돈, 네트워크 자원을 절약할 수 있다.
    -> *Ajax를 배우는 이유*
 - 단 하나의 기본적인 웹 페이지 구조를 재사용할 수 있다.
  + 바뀔 수 있는 부분과 고정되는 부분을 구분해서, 바뀔 수 있는 부분만 Ajax로 동적으로 변경시켜 주면, 폭발적인 생산성 향상이 있을 수 있다. 
  + 바뀔 수 있는 부분은 Ajax를 통해 서버로부터 동적으로 가져와서 넣는다.
  + SPA(Single Page Application) : 하나의 페이지로 여러 정보들을 표현할 수 있는 어플리케이션.

## Fetch API
 - fetch API를 활용하여 Ajax 구현
 - 코드 분석
  + fetch('javascript') : 웹 브라우저에게 서버로부터 'javascript'라는 이름의 파일을 요청하고 받아온다.
  + then(functionName) : 웹 서버로부터 응답을 받은 이후의 동작. 인자로 넘겨진 함수를 수행.
   응답을 기다리는 동안 다른 코드를 실행한다. 즉, fetch 함수는 Asynchronous한 방식으로 동작한다. 
   일반적으로 then의 인자로 들어가는 함수는 익명함수를 쓴다. 
  + response 객체
   - status속성 : 응답상태. 200 = 성공, 404 : NOT FOUND
   - response 객체는 fetch를 통해 서버에 요청했을 때, 서버가 응답한 결과를 담고 있는 데이터이다.
   - 내부에 있는 여러가지 속성을 통해 서버와의 통신 상태를 알 수 있다.
 - onclick의 value 값으로 Fetch API를 사용함으로서 Ajax 구현이 가능하다.

## SPA 의 한계
 - list 가 link 처럼 보이지 않음
 - 주소를 통한 페이지 공유가 불가능하다.(Single Page 이므로)
 - 어떻게 해결할 수 있을까?
  + Fragment Identifier : 페이지 내부 조각에 대한 id를 준다.
  + location.hash 명령어를 통해 현재 페이지의 hash 정보를 알 수 있다.
 - 위 해결방식의 문제점?
  + SEO(Search Engine Optimization) 이 잘 안된다.
    실제 웹 페이지의 정보는 없고, backend에서 text 데이터를 가져다가 붙이므로
  + 뒤로가기를 눌렀을 때, 페이지 정보가 변경되지 않는다.
 - 그럼 최근에는 어떤 방식을 사용할까?
  + pjax
  + 현재까지 사용했던 방법을 보완하는 방식. 나중에 필요하면 찾아볼 것. 

## 글 목록 Ajax로 구현하기
 - 프로그래머들은 데이터와 로직(애플리케이션)을 구분한다.
 - 현재 index.html은 데이터이면서 로직이다. 둘이 혼재되어 있다.
 - 글 목록은 data로서의 성격을 가지고 있다. 밖으로 쪼개보자.
 - fetch API를 사용해서 list 문서로 데이터 정보를 분리할 수 있다.

## Fetch API polyfill
 - fetch API 가 비교적 최신기술이라 IE 등의 익스플로러에서는 동작하지 않을 수 있다.
 - polyfill library를 사용해 이 문제를 해결할 수 있다.
 - fetch.js를 페이지에 포함시켜주면 오래된 브라우저까지 챙길 수 있다.

## Ajax 수업을 마치며
 - Ajax를 이용해서 페이지의 전환 없이도 서버로부터 데이터를 부분적으로 가져와서 동적으로 페이지의 내용을 교체하는 방법을 알아보았다.
 - 이를 통해 페이지 단위로 머물러 있던 웹은 문서에서 확장되어서 본격적인 어플리케이션 대열에 합류하게 된다.
   이는 웹을 바라보는 사람들의 시각을 근본적으로 변화시켰다.
   웹이 더이상 문서가 아닌 것이 아니라, 웹은 문서라는 토대 위에 어플리케이션이라는 좀더 동적이고 사용자 친화적인 것을 얹은 것이다.
   웹이 다른 앱들과 구분되는 가장 중요한 특징은 *검색이 된다는 것*이다.
   웹이 가지고 있는 가장 중요한 특성은, 검색이 되면서도 어플리케이션으로서 역할을 할 수 있다는 것이다.
 - Ajax는 Asynchronous JavaScript and XML의 약자이다. 
   XML은 분리된 데이터를 좀 더 풍부하게 표현할 수 있도록 돕는 언어이다. 
   우리가 앞선 예제에서 list 파일을 콤마(,)만으로 구분했는데, 이 콤마만으로 구분하는 것이 버거울 때 XML을 살펴보면 좋다. 
 - XML의 경쟁상대인 JSON. JSON이 승기를 잡고 있음. XML 보다는 JSON 사용을 권한다.
 - 우리가 지금까지 만들었던 application은 javascript와 ajax를 중심으로 해서 reload 없이 동작하는 웹사이트이다. 
   이러한 웹 어플리케이션 제작 기법을 SPA(Single Page Application)이라고 한다.
   우리 수업에서는 매우 기본적인 제작 기법을 활용했지만, 검색해 보면 다양한 방법의 제작 기법이 존재한다.
   이를테면, SPA 제작의 중요한 기술로 평가되는 PJAX가 있다. 페이지를 리로드하지 않고, 부분적으로 데이터를 교체하면서도 검색 엔진과 같은 로봇들이 데이터에 접근하는 것을 방해하지 않는 기능을 만드는 것을 목적으로 한다. 
   SEO를 위한다면, PJAX를 활용해보는 것이 좋다. 
 - PWA(Progressive Web Apps) : SPA의 발전된 형태. SPA가 Ajax를 골격으로 
   만들어진 일련의 웹 어플리케이션을 말하는 유행어라면, PWA는 SPA을 기반으로 
   만들어진 웹 앱에 offline에서도 동작하는 특성을 추가한 것이다. 
   웹의 가장 큰 단점은, 웹이 오프라인에서는 동작하지 않는다는 것이다.
   최근의 웹 기술들은, 웹을 오프라인에서도 동작하도록 하는 특성들이 대거 추가되고 있다.
   즉, 최신의 데이터를 유지하는 online 적인 특성과 offline에서도 동작하는 어플리케이션적인 특성이 결합되는 형태로 웹이 진화하고 있는 것이다.  
